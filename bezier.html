
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Bézier curves &mdash; inkscape-pybounds 0.9.0 alpha 1</title>
    <link rel="stylesheet" href="static/default.css" type="text/css" />
    <link rel="stylesheet" href="static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.9.0 alpha 1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="static/jquery.js"></script>
    <script type="text/javascript" src="static/underscore.js"></script>
    <script type="text/javascript" src="static/doctools.js"></script>
    <link rel="top" title="inkscape-pybounds 0.9.0 alpha 1" href="index.html" />
    <link rel="next" title="Elliptical arcs" href="elliptarc.html" />
    <link rel="prev" title="Helper functions" href="helperfuncs.html" />
 
<script type="text/javascript" src="templatebuiltins.js"></script>
<script type="text/javascript">
(function($) {
    if (!django_template_builtins) {
       // templatebuiltins.js missing, do nothing.
       return;
    }
    $(document).ready(function() {
        // Hyperlink Django template tags and filters
        var base = "ref/templates/builtins.html";
        if (base == "#") {
            // Special case for builtins.html itself
            base = "";
        }
        // Tags are keywords, class '.k'
        $("div.highlight\\-html\\+django span.k").each(function(i, elem) {
             var tagname = $(elem).text();
             if ($.inArray(tagname, django_template_builtins.ttags) != -1) {
                 var fragment = tagname.replace(/_/, '-');
                 $(elem).html("<a href='" + base + "#" + fragment + "'>" + tagname + "</a>");
             }
        });
        // Filters are functions, class '.nf'
        $("div.highlight\\-html\\+django span.nf").each(function(i, elem) {
             var filtername = $(elem).text();
             if ($.inArray(filtername, django_template_builtins.tfilters) != -1) {
                 var fragment = filtername.replace(/_/, '-');
                 $(elem).html("<a href='" + base + "#" + fragment + "'>" + filtername + "</a>");
             }
        });
    });
})(jQuery);
</script>

  </head>
  <body>

    <div class="document">
  <div id="custom-doc" class="yui-t6">
    <div id="hd">
      <h1><a href="index.html">inkscape-pybounds 0.9.0 alpha 1</a></h1>
      <div id="global-nav">
        <a title="Home page" href="index.html">Home</a>  |
        <a title="Global index" href="genindex.html">Index</a>  |
      </div>
      <div class="nav">
    &laquo; <a href="helperfuncs.html" title="Helper functions">previous</a>
     |
    <a title="inkscape-pybounds 0.9.0 alpha 1" href="index.html" accesskey="U">up</a>
   |
    <a href="elliptarc.html" title="Elliptical arcs">next</a> &raquo;</div>
    </div>

    <div id="bd">
      <div id="yui-main">
        <div class="yui-b">
          <div class="yui-g" id="bezier">
            
  <div class="section" id="bezier-curves">
<span id="bezier"></span><h1>Bézier curves<a class="headerlink" href="#bezier-curves" title="Permalink to this headline">¶</a></h1>
<p>The Bézier curve is a parametric curve commonly used in graphics applications
as they are smooth and scalable. They were first developed in 1959 by Paul de
Casteljau, and were widely publicised by Pierre Bézier. The Bézier curve of
degree <img class="math" src="images/math/174fadd07fd54c9afe288e96558c92e0c1da733a.png" alt="n"/> is defined as</p>
<div class="math">
<p><img src="images/math/929f03d76195b074d1cea3c70ad62ba3561bc611.png" alt="B_n(t) = \sum_{i=0}^n b_{i,n}(t)P_i \qquad t \in [0,1]" /></p>
</div><p>where the polynomials</p>
<div class="math">
<p><img src="images/math/a0bcc415fbaf50e79aa2cd8ab877c58026504301.png" alt="b_{i,n}(t) = \frac{n!(1-t)^{n-1}t^i}{i!(n-i)!} \qquad i=0,1,\ldots,n" /></p>
</div><p>are known as the Bernstein basis polynomials, and the points
<img class="math" src="images/math/d149a557cc9d6a8f5139da498dec62872b8fd275.png" alt="P_0,P_1,\ldots,P_n"/> are the control points. The curve begins at <img class="math" src="images/math/241e6e35ad6d73fb2ef98244b0211deb2f25222a.png" alt="P_0"/>
and ends at <img class="math" src="images/math/54c51a4acedda645113145d008dbfb50d35f1da3.png" alt="P_n"/>.</p>
<p>The derivative of a Bézier curve is given by</p>
<div class="math">
<p><img src="images/math/5e43ebab4202e6e362ebc6432584c9cfb0a086af.png" alt="B_n'(t) = \sum_{i=0}^{n-1} b_{i,n-1}(t)Q_i" /></p>
</div><p>where <img class="math" src="images/math/d599545c5671499b58f2c78fbba102238b1e139b.png" alt="Q_i = n(P_{i+1} - P_i)"/>, i.e., the derivative is itself a Bézier
curve of degree <img class="math" src="images/math/4bdca93962a2beaffc172ca394e04fe05bd74ffd.png" alt="n-1"/>.</p>
<p>SVG (and thus Inkscape) uses both quadratic (<img class="math" src="images/math/6cb7ae00764b56ee2adf59e78a1ffde9685b80db.png" alt="n=2"/>) and cubic (<img class="math" src="images/math/5635737307f5f0651cced8ee2e6558a426fd27b5.png" alt="n=3"/>)
Bézier curves. Hence we need to be able to calculate the bounding box of a Bézier
curve.</p>
<div class="section" id="loose-bounds">
<h2>Loose bounds<a class="headerlink" href="#loose-bounds" title="Permalink to this headline">¶</a></h2>
<p>The convex hull of the control points <img class="math" src="images/math/d149a557cc9d6a8f5139da498dec62872b8fd275.png" alt="P_0,P_1,\ldots,P_n"/> contains the
entire curve. Hence, a bounding box which encompasses all the control points is
guaranteed to encompass the curve. However, unless all the control points are
colinear (i.e., the curve actually describes a straight line), this will not be
a tight bounding box.</p>
</div>
<div class="section" id="tight-bounds">
<h2>Tight bounds<a class="headerlink" href="#tight-bounds" title="Permalink to this headline">¶</a></h2>
<p>The curve is guaranteed to pass through the start and end points (<img class="math" src="images/math/241e6e35ad6d73fb2ef98244b0211deb2f25222a.png" alt="P_0"/>
and <img class="math" src="images/math/54c51a4acedda645113145d008dbfb50d35f1da3.png" alt="P_n"/>) so the initial bounding box is one that encompasses these two
points. We then need to extend it so it includes the maxima and minima of the
curve. To find the locations of these extrema, we set the derivative of the
curve to zero and solve for <img class="math" src="images/math/e0d2bf360290fd61d1c1557e763f2622363b3d35.png" alt="t"/>. The extrema themselves can then be found
by evaluating the curve at these locations.</p>
<p>If we have an existing bounding box (e.g, if this curve is not the first path
segment we are getting a box for), we can check if all the control points
already fit inside this box. If so, there is no need to continue as the
existing box already encompasses the entire curve.</p>
<div class="section" id="quadratic-bezier-curve">
<h3>Quadratic Bézier curve<a class="headerlink" href="#quadratic-bezier-curve" title="Permalink to this headline">¶</a></h3>
<p>A quadratic Bézier curve requires three control points, and is defined by the
formula</p>
<div class="math">
<p><img src="images/math/f4a981049d0c688e645665e9ca7059059b2c62c0.png" alt="B_2(t) = (1 - t)^2P_0 + 2(1 - t)tP_1 + t^2P_2" /></p>
</div><p>Its derivative is</p>
<div class="math">
<p><img src="images/math/9b35f20ea9808b7430dd8765b021d7eb57546d5b.png" alt="B_2'(t) = 2(1 - t)Q_0 + 2tQ_1" /></p>
</div><p>Setting this to zero and solving for <img class="math" src="images/math/e0d2bf360290fd61d1c1557e763f2622363b3d35.png" alt="t"/> gives</p>
<div class="math">
<p><img src="images/math/f7eb1210a4b858326ae23897ee6e1a6455979e0b.png" alt="t = \frac{Q_0}{Q_0 - Q_1}" /></p>
</div><p>As we need to find the extrema in both the x and y dimensions, we need to split
this into two:</p>
<div class="math">
<p><img src="images/math/14bcb4bc5b6e4cd174cd2acec5e4ac635271e17c.png" alt="t_x &amp;= \frac{Q_{0,x}}{Q_{0,x} - Q_{1,x}} \\
t_y &amp;= \frac{Q_{0,y}}{Q_{0,y} - Q_{1,y}}" /></p>
</div><p>If <img class="math" src="images/math/8f48e9d16ee54d826ec211d1b3f3dd9af852062d.png" alt="0 &lt; t_x &lt; 1"/> then this is the location of an extrema in the x
dimension, and hence we extend the bounding box to encompass the x value of
<img class="math" src="images/math/7c38ef15ae6f83cb53c0e1e01bb6878b27cae945.png" alt="B_2(t_x)"/>. Similarly, if <img class="math" src="images/math/32484fb00ae756a4a349c381afff7e6aaf9a186a.png" alt="0 &lt; t_y &lt; 1"/> we have an extrema in the
y direction, and hence extend the bounding box to encompass the y value of
<img class="math" src="images/math/05efd2bdb1e0c927881da2921180566f34553ba0.png" alt="B_2(t_y)"/>. We now have a tight bounding box for the curve.</p>
</div>
<div class="section" id="cubic-bezier-curve">
<h3>Cubic Bézier curve<a class="headerlink" href="#cubic-bezier-curve" title="Permalink to this headline">¶</a></h3>
<p>A cubic Bézier curve require four control points, and is defined by the
function</p>
<div class="math">
<p><img src="images/math/3656fb7f9b7ac9e7f5690bd402578922584b29ad.png" alt="B_3(t) = (1 - t)^3P_0 + 3(1 - t)^2tP_1 + 3(1 - t)t^2P_2 + t^3P_3" /></p>
</div><p>Its derivative is the quadratic Bézier curve</p>
<div class="math">
<p><img src="images/math/9c6ec92bde5aff5adc30ea1d7a5d8ad295be6d65.png" alt="B_3'(t) = 3(1 - t)^2Q_0 + 6(1 - t)tQ_1 + 3t^2Q_2" /></p>
</div><p>Setting this to zero and expanding and collecting terms gives the quadratic
equation</p>
<div class="math">
<p><img src="images/math/ece90fcb13e45ec8413b459066756981e9d80189.png" alt="\left(3Q_0 - 6Q_1 + 3Q_2\right)t^2 + \left(-6Q_0 + 6Q_1\right)t + 3Q_0 = 0" /></p>
</div><p>Applying the quadratic formula gives</p>
<div class="math">
<p><img src="images/math/f9440446c2a8c8574f031c387db24bc22770897c.png" alt="t = \frac{-b \pm \sqrt{b^2 - 4ac}}{2a}" /></p>
</div><p>where</p>
<div class="math">
<p><img src="images/math/e45ca3f5fcd25b59ed9a9e421c26c80ec2a808ba.png" alt="a &amp;= 3Q_0 - 6Q_1 + 3Q_2 \\
b &amp;= -6Q_0 + 6Q_1 \\
c &amp;= 3Q_0" /></p>
</div><p>As with the quadratic Bézier curve, we need to split this into the x and y
components to find the extrema in both dimensions. Either one or two possible
solutions will be found by the quadratic formula in each dimension. To be
valid, a solution must be real and meet the criteria <img class="math" src="images/math/a0488ee735a04ceaf2e0e707425343131eed5c97.png" alt="0 &lt; t &lt; 1"/>. If this
is the case, <img class="math" src="images/math/1d0a470a25d760d705f292ae5c7620bca01cb6fd.png" alt="B_3(t)"/> is evaluated at this point and the bounding box is
extended appropriately. Once this has been completed for all solutions in both
dimensions, we have a tight bounding box for the curve.</p>
</div>
</div>
<div class="section" id="external-links">
<h2>External links<a class="headerlink" href="#external-links" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><a class="reference external" href="http://en.wikipedia.org/wiki/B%C3%A9zier_curve">Bézier curve</a> at Wikipedia</li>
<li><a class="reference external" href="http://www.cs.mtu.edu/~shene/COURSES/cs3621/NOTES/spline/Bezier/bezier-der.html">Derivatives of a Bézier curve</a></li>
</ul>
</div>
</div>


          </div>
        </div>
      </div>
      
        
          <div class="yui-b" id="sidebar">
            
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Bézier curves</a><ul>
<li><a class="reference internal" href="#loose-bounds">Loose bounds</a></li>
<li><a class="reference internal" href="#tight-bounds">Tight bounds</a><ul>
<li><a class="reference internal" href="#quadratic-bezier-curve">Quadratic Bézier curve</a></li>
<li><a class="reference internal" href="#cubic-bezier-curve">Cubic Bézier curve</a></li>
</ul>
</li>
<li><a class="reference internal" href="#external-links">External links</a></li>
</ul>
</li>
</ul>

  <h3>Browse</h3>
  <ul>
    
      <li>Prev: <a href="helperfuncs.html">Helper functions</a></li>
    
    
      <li>Next: <a href="elliptarc.html">Elliptical arcs</a></li>
    
  </ul>
  <h3>You are here:</h3>
  <ul>
      <li>
        <a href="index.html">inkscape-pybounds 0.9.0 alpha 1</a>
        
        <ul><li>Bézier curves</li></ul>
        
      </li>
  </ul>

  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="sources/bezier.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" size="18" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
              <h3>Last update:</h3>
              <p class="topless">Oct 10, 2010</p>
          </div>
        
      
    </div>

    <div id="ft">
      <div class="nav">
    &laquo; <a href="helperfuncs.html" title="Helper functions">previous</a>
     |
    <a title="inkscape-pybounds 0.9.0 alpha 1" href="index.html" accesskey="U">up</a>
   |
    <a href="elliptarc.html" title="Elliptical arcs">next</a> &raquo;</div>
    </div>
  </div>

      <div class="clearer"></div>
    </div>
  </body>
</html>